<project name="hex_utils" default="test" xmlns:ivy="antlib:org.apache.ivy.ant">
    <include file="../build-common.xml" as="common"/>
    <property name="out.dir" value="../out/production"/>
    <property name="test.out.dir" value="../out/test"/>
    <property name="classes.dir" value="${out.dir}/hex_utils"/>
    <property name="test.classes.dir" value="${test.out.dir}/hex_utils"/>

    <target name="clean" description="Delete all output directories to ensure a fresh build">
        <delete dir="${classes.dir}"/>
        <delete dir="${test.classes.dir}"/>
    </target>

    <target name="compile">
        <mkdir dir="${classes.dir}"/>
        <javac destdir="${classes.dir}" srcdir="${basedir}/src"/>
    </target>

    <target name="compile-tests" depends="compile">
        <mkdir dir="${test.classes.dir}"/>
        <ivy:cachepath conf="test" pathid="ivy.cachepath"/>
        <javac destdir="${test.classes.dir}" srcdir="${basedir}/test">
            <classpath path="${classes.dir}"/>
            <classpath refid="ivy.cachepath"/>
        </javac>
    </target>

    <target name="test" description="Run the tests!" depends="compile,compile-tests">
        <junit printsummary="true">
            <test name="hex.utils.InflectionTest"/>
            <classpath refid="ivy.cachepath"/>
            <classpath path="${classes.dir}"/>
            <classpath path="${test.classes.dir}"/>
        </junit>
    </target>
</project>
